

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>hong2p.util module &mdash; hong2p 0.0.0 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="hong2p.viz module" href="hong2p.viz.html" />
    <link rel="prev" title="hong2p.types module" href="hong2p.types.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> hong2p
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">hong2p</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="hong2p.html">hong2p package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="hong2p.html#submodules">Submodules</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="hong2p.err.html">hong2p.err module</a></li>
<li class="toctree-l4"><a class="reference internal" href="hong2p.latex.html">hong2p.latex module</a></li>
<li class="toctree-l4"><a class="reference internal" href="hong2p.olf.html">hong2p.olf module</a></li>
<li class="toctree-l4"><a class="reference internal" href="hong2p.roi.html">hong2p.roi module</a></li>
<li class="toctree-l4"><a class="reference internal" href="hong2p.suite2p.html">hong2p.suite2p module</a></li>
<li class="toctree-l4"><a class="reference internal" href="hong2p.thor.html">hong2p.thor module</a></li>
<li class="toctree-l4"><a class="reference internal" href="hong2p.types.html">hong2p.types module</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">hong2p.util module</a></li>
<li class="toctree-l4"><a class="reference internal" href="hong2p.viz.html">hong2p.viz module</a></li>
<li class="toctree-l4"><a class="reference internal" href="hong2p.xarray.html">hong2p.xarray module</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="hong2p.html#module-hong2p">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">hong2p</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="modules.html">hong2p</a> &raquo;</li>
        
          <li><a href="hong2p.html">hong2p package</a> &raquo;</li>
        
      <li>hong2p.util module</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/apidoc/hong2p.util.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-hong2p.util">
<span id="hong2p-util-module"></span><h1>hong2p.util module<a class="headerlink" href="#module-hong2p.util" title="Permalink to this headline">¶</a></h1>
<p>Common functions for dealing with Thorlabs software output / stimulus metadata /
our databases / movies / CNMF output.</p>
<dl class="py exception">
<dt id="hong2p.util.IOPerformanceWarning">
<em class="property"><span class="pre">exception</span> </em><code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">IOPerformanceWarning</span></code><a class="reference internal" href="../_modules/hong2p/util.html#IOPerformanceWarning"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.IOPerformanceWarning" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Warning</span></code></p>
<p>Warning that data does not seem to be read/written from fast storage</p>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.add_fly_id">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">add_fly_id</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#add_fly_id"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.add_fly_id" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="hong2p.util.add_group_id">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">add_group_id</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_keys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">letter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_at_one</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#add_group_id"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.add_group_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds integer column to identify unique combinations of group_keys.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">DataArray</span></code>]) – DataFrame or DataArray to add metadata to</p></li>
<li><p><strong>letter</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – if True, use letters starting from ‘A’ (rather than integers) for the
new ID variable</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.add_missing_odor_cols">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">add_missing_odor_cols</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">missing_df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#add_missing_odor_cols"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.add_missing_odor_cols" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="hong2p.util.add_recording_id">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">add_recording_id</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#add_recording_id"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.add_recording_id" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="hong2p.util.addlevel">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">addlevel</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">values</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'index'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#addlevel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.addlevel" title="Permalink to this definition">¶</a></dt>
<dd><p>Add level(s) to pandas MultiIndex</p>
<p>Intended to be an inverse to pandas.DataFrame.droplevel. pandas.DataFrame.set_index
with <cite>append=True</cite> would work <em>except</em> that there is no <cite>axis</cite> kwarg to that
function, so it does not work for the columns. pandas.DataFrame.unstack is almost
what I would want, but it can seemingly arbitrarily change order of rows.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code>) – DataFrame to add MultiIndex levels to</p></li>
<li><p><strong>names</strong> – <cite>str</cite>/sequence-of-<cite>str</cite> name(s) for the new levels</p></li>
<li><p><strong>values</strong> – values for the new levels. If <cite>names</cite> is a sequence, this should be of
the same length.</p></li>
<li><p><strong>axis</strong> – 0/’index’ or 1/’columns’, defauling to ‘index’ as in pandas</p></li>
</ul>
</dd>
</dl>
<p>Returns: DataFrame with MultiIndex containing names/levels from input</p>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.analysis_fly_dir">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">analysis_fly_dir</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fly</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#analysis_fly_dir"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.analysis_fly_dir" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.analysis_intermediates_root">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">analysis_intermediates_root</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#analysis_intermediates_root"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.analysis_intermediates_root" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.analysis_output_root">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">analysis_output_root</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#analysis_output_root"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.analysis_output_root" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.arraylike_cols">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">arraylike_cols</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#arraylike_cols"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.arraylike_cols" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of columns that have only lists or arrays as elements.</p>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.assign_frames_to_trials">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">assign_frames_to_trials</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">movie</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">presentations_per_block</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">block_first_frames</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">odor_onset_frames</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#assign_frames_to_trials"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.assign_frames_to_trials" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns arrays trial_start_frames, trial_stop_frames</p>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.baselined_normed_u8">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">baselined_normed_u8</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#baselined_normed_u8"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.baselined_normed_u8" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="hong2p.util.calculate_df_over_f">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">calculate_df_over_f</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raw_f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trial_start_frames</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">odor_onset_frames</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trial_stop_frames</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#calculate_df_over_f"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.calculate_df_over_f" title="Permalink to this definition">¶</a></dt>
<dd><p>for b_start, b_end in zip(block_first_frames, block_last_frames):</p>
<blockquote>
<div><dl>
<dt>for c in range(n_footprints):</dt><dd><p># TODO TODO TODO TODO need to be (b_end + 1) since not
# inclusive? (&lt;-fixed) other problems like this elsewhere?????
# TODO maybe smooth less now that df/f is being calculated more
# sensibly…
raw_f[b_start:(b_end + 1), c] = smooth_1d(</p>
<blockquote>
<div><p>raw_f[b_start:(b_end + 1), c], window_len=11</p>
</div></blockquote>
<p>)</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.cell_ids">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">cell_ids</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#cell_ids"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.cell_ids" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a DataFrame with ‘cell’ in MultiIndex or columns to unique values.</p>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.check_dir_exists">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">check_dir_exists</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn_returning_dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#check_dir_exists"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.check_dir_exists" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="hong2p.util.check_index_vals_unique">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">check_index_vals_unique</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#check_index_vals_unique"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.check_index_vals_unique" title="Permalink to this definition">¶</a></dt>
<dd><p>Raises AssertionError if any duplicates in column/index indices.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.const_ranges">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">const_ranges</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xs</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#const_ranges"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.const_ranges" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns tuples of indices for largest contiguous constant-value ranges in input.</p>
<p>All elements in input sequence should be included in exactly one (start, stop) index
tuple. Range tuples should all be in order, and stop indices are inclusive, so the
end of one range should be one less than the start of the next range.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>include_val</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – if True, each tuple in output will be length 3, with the first
element the value for the range specified by (start, stop) indices in the
remaining elements of the tuple. If False, each tuple will be length 2, just
containing these (start, stop) indices.</p>
</dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">const_ranges</span><span class="p">([</span><span class="s1">&#39;MCH&#39;</span><span class="p">,</span> <span class="s1">&#39;MCH&#39;</span><span class="p">,</span> <span class="s1">&#39;OCT&#39;</span><span class="p">,</span> <span class="s1">&#39;OCT&#39;</span><span class="p">])</span>
<span class="go">[(0, 1), (2, 3)]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">const_ranges</span><span class="p">([</span><span class="s1">&#39;MCH&#39;</span><span class="p">,</span> <span class="s1">&#39;MCH&#39;</span><span class="p">,</span> <span class="s1">&#39;OCT&#39;</span><span class="p">,</span> <span class="s1">&#39;OCT&#39;</span><span class="p">],</span> <span class="n">include_val</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">[(&#39;MCH&#39;, 0, 1), (&#39;OCT&#39;, 2, 3)]</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]], <code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.data_root">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">data_root</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#data_root"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.data_root" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.date_fly_list2paired_thor_dirs">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">date_fly_list2paired_thor_dirs</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">date_fly_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_first</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_full_paths</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">pair_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#date_fly_list2paired_thor_dirs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.date_fly_list2paired_thor_dirs" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes list of (date, fly_num) tuples to pairs of their Thor outputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>date_fly_list</strong> (<em>list of</em><em> (</em><em>date-like</em><em>, </em><em>int</em><em>)</em>) – (date, fly number) tuples</p></li>
<li><p><strong>n_first</strong> (<em>None | int</em>) – If passed, only up to this many of pairs are enumerated.
Intended for testing on subsets of data.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – (default=False) If True, prints the fly/ThorImage/ThorSync
directories as they are being iterated over.</p></li>
<li><p><strong>**pair_kwargs</strong> – Passed through to <cite>thor.pair_thor_subdirs</cite>. See arguments to
<cite>thor.pair_thor_dirs</cite> (called by <cite>thor.pair_thor_subdirs</cite>) for most of the
useful options.</p></li>
</ul>
</dd>
</dl>
<p>Each output is of the form:
((date, fly_num), (thorimage_dir&lt;i&gt;, thorsync_dir&lt;i&gt;))</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Generator</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Timestamp</span></code>, <code class="xref py py-func docutils literal notranslate"><span class="pre">NewType()</span></code>(<code class="xref py py-data docutils literal notranslate"><span class="pre">FlyNum</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>)], <code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code>]], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.df_to_odor_order">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">df_to_odor_order</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_name1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#df_to_odor_order"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.df_to_odor_order" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a complex-mixture DataFrame to odor names in desired plot order.</p>
<p>Args:
df (pd.DataFrame): should have a ‘original_name1’ column, with names of</p>
<blockquote>
<div><p>odors from complex mixture experiments we have pre-defined odor orders
for.</p>
</div></blockquote>
<dl class="simple">
<dt>observed (bool): (optional, default=True) If True, only return odor names</dt><dd><p>in <cite>df</cite>.</p>
</dd>
<dt>return_name1 (bool): (optional, default=False) If True, corresponding</dt><dd><p>values in ‘name1’ will be returned for each value in ‘original_name1’.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.diff_dataframes">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">diff_dataframes</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#diff_dataframes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.diff_dataframes" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a DataFrame summarizing input differences, or None if no differences.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.dir2keys">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">dir2keys</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#dir2keys"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.dir2keys" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns (date, fly_num, thorimage_id) for dir with these as last three parts.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Timestamp</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.downsample_movie">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">downsample_movie</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">movie</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_fps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">current_fps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_overshoot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_uneven_division</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relative_fps_err</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#downsample_movie"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.downsample_movie" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns downsampled movie by averaging consecutive groups of frames.</p>
<p>Groups of frames averaged do not overlap.</p>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.drop_incomplete_presentations">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">drop_incomplete_presentations</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#drop_incomplete_presentations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.drop_incomplete_presentations" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="hong2p.util.drop_orphaned_presentations">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">drop_orphaned_presentations</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#drop_orphaned_presentations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.drop_orphaned_presentations" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="hong2p.util.dtypes_equal">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">dtypes_equal</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reorder_cols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cast</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#dtypes_equal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.dtypes_equal" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.euclidean_dist">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">euclidean_dist</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#euclidean_dist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.euclidean_dist" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="hong2p.util.exp_decay">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">exp_decay</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#exp_decay"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.exp_decay" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="hong2p.util.expand_array_cols">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">expand_array_cols</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#expand_array_cols"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.expand_array_cols" title="Permalink to this definition">¶</a></dt>
<dd><p>Expands any list/array entries, with new rows for each entry.</p>
<p>For any columns in <cite>df</cite> that have all list/array elements (at each row),
the column in <cite>out_df</cite> will have the type of single elements from those
arrays.</p>
<p>The length of <cite>out_df</cite> will be the length of the input <cite>df</cite>, multiplied by
the length (should be common in each input row) of each set of list/array
elements.</p>
<p>Other columns have their values duplicated, to match the lengths of the
expanded array values.</p>
<p>Args:
<cite>df</cite> (pd.DataFrame)</p>
<p>Returns:
<cite>out_df</cite> (pd.DataFrame)</p>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.first_group">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">first_group</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_cols</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#first_group"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.first_group" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns key tuple and df of first group, grouping df on group_cols.</p>
<p>Just for ease of interactively testing out functions on DataFrames of a
groupby.</p>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.fit_exp_decay">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">fit_exp_decay</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">signal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">times</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numerical_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#fit_exp_decay"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.fit_exp_decay" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns fit parameters for an exponential decay in the input signal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>signal</strong> (<em>1 dimensional np.ndarray</em>) – time series, beginning at decay onset</p></li>
<li><p><strong>sampling_rate</strong> (<em>float</em>) – sampling rate in Hz</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.format_date">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">format_date</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">date</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#format_date"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.format_date" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a pandas Timestamp or something that can be used to construct one
and returns a str with the formatted date.</p>
<p>Used to name directories by date, etc.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.format_keys">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">format_keys</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fly</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">other_keys</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#format_keys"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.format_keys" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="hong2p.util.format_mixture">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">format_mixture</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#format_mixture"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.format_mixture" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <cite>str</cite> representing 2-component odor mixture.</p>
<p>Input can be any of:
- 2 <cite>str</cite> names
- 2 names and concs (n1, n2, c1, c2)
- a pandas.Series / dict with keys <cite>name1</cite>, <cite>name2</cite>, and (optionally)</p>
<blockquote>
<div><p><cite>log10_concvv&lt;1/2&gt;</cite></p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.format_odor_conc">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">format_odor_conc</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log10_conc</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#format_odor_conc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.format_odor_conc" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes <cite>str</cite> odor name and log10 concentration to a formatted <cite>str</cite>.</p>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.format_params">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">format_params</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">',</span> <span class="pre">'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'#.3g'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">abbrevs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#format_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.format_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Formats dict with params into one string.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>sort</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to sort keys</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.format_timestamp">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">format_timestamp</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">timestamp</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#format_timestamp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.format_timestamp" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns human-readable str for timestamp accepted by <cite>pd.Timestamp</cite>, to minute.</p>
<p>Ex: ‘2022-04-07 16:53’</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.frame_pdist">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">frame_pdist</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'euclidean'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#frame_pdist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.frame_pdist" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a DataFrame matrix of all pairwise distances between input rows.</p>
<p>Returns output of same shape as DataFrame.corr() (calculating distances between
all pairs of input <em>rows</em>), so output rows and columns will be same as input
columns.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.full_frame_avg_trace">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">full_frame_avg_trace</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">movie</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#full_frame_avg_trace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.full_frame_avg_trace" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a (t,[z,]x,y) movie to t-length vector of frame averages.</p>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.get_axis_index">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">get_axis_index</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#get_axis_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.get_axis_index" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Index</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.get_fly_dir">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">get_fly_dir</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fly</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#get_fly_dir"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.get_fly_dir" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns str path fragment as YYYY-MM-DD/&lt;n&gt; for variety of input types</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.git_hash">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">git_hash</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">repo_file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#git_hash"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.git_hash" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes any file in a git directory and returns current hash.</p>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.gsheet_csv_export_link">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">gsheet_csv_export_link</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_with_edit_link</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_append_gid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_search_dirs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#gsheet_csv_export_link"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.gsheet_csv_export_link" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a gsheet link copied from browser while editing it, and returns a
URL suitable for reading it as a CSV into a DataFrame.</p>
<p>GID seems to default to 0 for the first sheet, but seems unpredictable for further
sheets in the same document, though you can extract it from the URL in those cases.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.gsheet_to_frame">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">gsheet_to_frame</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_with_edit_link</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bool_fillna_false</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convert_date_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_trailing_bools</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">restore_ints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_col_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_cache</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_search_dirs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#gsheet_to_frame"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.gsheet_to_frame" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_with_edit_link</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code>]) – </p></li>
<li><p><strong>gid</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – </p></li>
<li><p><strong>bool_fillna_false</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to replace missing values in columns that otherwise
only contain True/False with False. will convert column dtype to ‘bool’ as
well.</p></li>
<li><p><strong>convert_date_col</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to convert the contents of any columns named ‘date’
(case insensitive) to <cite>pd.Timestamp</cite></p></li>
<li><p><strong>drop_trailing_bools</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – <p>whether to drop blocks of False in bool columns beyond the
last row where all non-bool columns have any non-NaN values.</p>
<p>If a column has data validation for a boolean, the frame will have values
(False as I’ve seen it so far) through to the end of the validation range,
despite the fact that no data has been entered.</p>
</p></li>
<li><p><strong>restore_ints</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to convert columns parsed as floats (because missing data
in rows where only default values for bool cols are present) to an integer
type. Requires that drop_trailing_bools actually gets rid of all the NaN
values in the columns to be converted to ints (float columns with only whole
number / NaN values).</p></li>
<li><p><strong>normalize_col_names</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to rename columns using the
<cite>hong2p.util.to_filename</cite> (with <cite>period=False</cite> to that function) as well as
lowercasing.</p></li>
<li><p><strong>use_cache</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to try loading cached Google sheet data, if there is a
connection error when trying to load the sheet data from online. Each call
will unconditionally write to this cache, saved as a hidden file in the same
directory as <cite>file_with_edit_link</cite>.</p></li>
<li><p><strong>extra_search_dirs</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code>]]]) – extra directories to search for file with name
<cite>file_with_edit_link</cite>. will be searched before defaults (current directory
and hong2p root)</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.have_all_repeats">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">have_all_repeats</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_repeats</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#have_all_repeats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.have_all_repeats" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if a recording has all blocks gsheet says it has, w/ full
number of repeats for each. False otherwise.</p>
<p>Requires at least recording_from, comparison, name1, name2, and repeat_num
columns. Can also take prep_date, fly_num, thorimage_id.</p>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.have_full_comparisons">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">have_full_comparisons</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#have_full_comparisons"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.have_full_comparisons" title="Permalink to this definition">¶</a></dt>
<dd><p>Requires at least recording_from, comparison, name1, name2 columns.
Can also take prep_date, fly_num, thorimage_id.</p>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.index2dict_list">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">index2dict_list</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#index2dict_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.index2dict_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns list of dicts, each with <cite>index.names</cite> keys and index values.</p>
<p>Raises ValueError if <cite>index.names</cite> elements are not all of type <cite>str</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.invert_melt_symmetric">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">invert_melt_symmetric</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ser</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suffixes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('_a',</span> <span class="pre">'_b')</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#invert_melt_symmetric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.invert_melt_symmetric" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="hong2p.util.is_acquisition_host">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">is_acquisition_host</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#is_acquisition_host"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.is_acquisition_host" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.is_array_sorted">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">is_array_sorted</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#is_array_sorted"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.is_array_sorted" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns whether 1-dimensional np.ndarray is sorted.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.is_subrecording">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">is_subrecording</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">thorimage_id</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#is_subrecording"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.is_subrecording" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns whether a recording id matches my GUIs naming convention for the
“sub-recordings” it can create.</p>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.is_subrecording_tiff">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">is_subrecording_tiff</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tiff_filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#is_subrecording_tiff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.is_subrecording_tiff" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a TIFF filename to whether it matches the GUI’s naming convention for
the “sub-recordings” it can create.</p>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.latest_trace_pickles">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">latest_trace_pickles</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#latest_trace_pickles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.latest_trace_pickles" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns (date, fly, id) indexed DataFrame w/ filename and timestamp cols.</p>
<p>Only returns rows for filenames that had the latest timestamp for the
combination of index values.</p>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.list_motion_corrected_tifs">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">list_motion_corrected_tifs</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">include_rigid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attempt_analysis_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#list_motion_corrected_tifs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.list_motion_corrected_tifs" title="Permalink to this definition">¶</a></dt>
<dd><p>List motion corrected TIFFs in conventional directory structure on NAS.</p>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.load_metadata">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">load_metadata</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#load_metadata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.load_metadata" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns metadata from YAML, with defaults added.</p>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.load_movie">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">load_movie</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">thorimage_dir</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#load_movie"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.load_movie" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads movie and pre-processes (e.g. flipping) if metadata requests it.</p>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.load_odor_metadata">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">load_odor_metadata</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stimfile_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#load_odor_metadata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.load_odor_metadata" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns odor metadata loaded from pickle and additional computed values.</p>
<p>Additional values are added into the dictionary loaded from the pickle.
In some cases, this can overwrite the loaded values.</p>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.load_stimfile">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">load_stimfile</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stimfile_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#load_stimfile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.load_stimfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads odor metadata stored in a pickle.</p>
<p>These metadata files are generated by scripts under
<cite>ejhonglab/cutpast_arduino_stimuli</cite>.</p>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.mb_team_gsheet">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">mb_team_gsheet</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">use_cache</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">natural_odors_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_nonexistant_dirs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_inferred_paths</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_excluded_on_disk</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#mb_team_gsheet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.mb_team_gsheet" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a pandas.DataFrame with data on flies and MB team recordings.</p>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.md5">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">md5</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#md5"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.md5" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates MD5 hash on file with name <cite>fname</cite>.</p>
<p>Should match output of Linux utility md5sum.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.melt_symmetric">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">melt_symmetric</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">symmetric_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_constant_levels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suffixes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('_a',</span> <span class="pre">'_b')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_duplicate_values</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#melt_symmetric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.melt_symmetric" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a symmetric DataFrame to a tidy Series with unique values.</p>
<p>Symmetric means the row and columns indices are equal, and values should
be a symmetric matrix.</p>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.metadata_filename">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">metadata_filename</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">thorimage_dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#metadata_filename"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.metadata_filename" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns filename of YAML for extra metadata.</p>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.missing_odor_pairs">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">missing_odor_pairs</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#missing_odor_pairs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.missing_odor_pairs" title="Permalink to this definition">¶</a></dt>
<dd><p>Requires at least recording_from, comparison, name1, name2 columns.
Can also take prep_date, fly_num, thorimage_id.</p>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.missing_repeats">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">missing_repeats</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_repeats</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#missing_repeats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.missing_repeats" title="Permalink to this definition">¶</a></dt>
<dd><p>Requires at least recording_from, comparison, name1, name2, and repeat_num
columns. Can also take prep_date, fly_num, thorimage_id.</p>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.most_recent_contained_file_mtime">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">most_recent_contained_file_mtime</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recurse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#most_recent_contained_file_mtime"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.most_recent_contained_file_mtime" title="Permalink to this definition">¶</a></dt>
<dd><p>Recursively find the <cite>os.path.getmtime</cite> of the most recently modified file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code>]) – directory within which to check mtime of files</p></li>
<li><p><strong>recurse</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to check files under descendant directories of input</p></li>
<li><p><strong>verbose</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – prints which file had the most recent mtime (mostly for debugging)</p></li>
</ul>
</dd>
</dl>
<p>Returns None if there are no files in the directory.</p>
<p>Testing on Ubuntu, this does not recurse into symlinks to directories, as I want for
at least current use case.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.motion_corrected_tiff_filename">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">motion_corrected_tiff_filename</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fly_num</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thorimage_id</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#motion_corrected_tiff_filename"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.motion_corrected_tiff_filename" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes vars identifying recording to the name of a motion corrected TIFF
for it. Non-rigid preferred over rigid. Relies on naming convention.</p>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.movie_blocks">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">movie_blocks</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tif</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">movie</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_gsheet_to_restrict_blocks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stimfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_block</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_block</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#movie_blocks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.movie_blocks" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns list of arrays, one per continuous acquisition.</p>
<p><cite>tif</cite> must be named and placed according to convention, and a .mat file
created from <cite>ejhonglab/matlab_kc_plane</cite> (typically run via <cite>populate_db.py</cite>
in what is now my <cite>kc_natural_mixes</cite> repo) must exist in the conventional
path under the analysis root. This .mat file is used for the timing
information (ultimately derived mainly from ThorSync data).</p>
<p>Total length along time dimension should be preserved from input TIFF.</p>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.n_expected_repeats">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">n_expected_repeats</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#n_expected_repeats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.n_expected_repeats" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns expected # repeats given DataFrame w/ repeat_num col.</p>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.nan_eq">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">nan_eq</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arr2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#nan_eq"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.nan_eq" title="Permalink to this definition">¶</a></dt>
<dd><p>Elementwise equality of arrays, but True if both are NaN at a location.</p>
<p>Normally, NaN != NaN, but this is not the behavior I want when trying to check which
parts of an array/DataFrame were changed by an operation.</p>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.no_skipped_comparisons">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">no_skipped_comparisons</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#no_skipped_comparisons"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.no_skipped_comparisons" title="Permalink to this definition">¶</a></dt>
<dd><p>Requires at least recording_from and comparison columns.
Can also take prep_date, fly_num, and thorimage_id.</p>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.num_notnull">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">num_notnull</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#num_notnull"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.num_notnull" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.num_null">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">num_null</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#num_null"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.num_null" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.odorset_name">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">odorset_name</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_or_odornames</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#odorset_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.odorset_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns name for set of odors in DataFrame.</p>
<p>Looks at odors in original_name1 column. Name used to lookup desired
plotting order for the odors in the set.</p>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.pair_ordering">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">pair_ordering</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">comparison_df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#pair_ordering"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.pair_ordering" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a df w/ name1 &amp; name2 to a dict of their tuples to order int.</p>
<p>Order integers start at 0 and do not skip any numbers.</p>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.paired_thor_dirs">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">paired_thor_dirs</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">matching_substrs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_date</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_date</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_first</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_redone</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_skips</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_fast</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_full_paths</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">pair_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#paired_thor_dirs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.paired_thor_dirs" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates tuples of fly metadata and ThorImage output paths, in acquisition order</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>matching_substrs</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]]) – If passed, only experiments whose ThorImage path contains at
least one of these substring will be included.</p></li>
<li><p><strong>n_first</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – If passed, only up to this many of pairs are enumerated.
Intended for testing on subsets of data.</p></li>
<li><p><strong>verbose</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – If True, prints the fly/ThorImage/ThorSync directories as they are
being iterated over.</p></li>
<li><p><strong>**pair_kwargs</strong> – Passed through to <cite>thor.pair_thor_subdirs</cite>. See arguments to
<cite>thor.pair_thor_dirs</cite> (called by <cite>thor.pair_thor_subdirs</cite>) for most of the
useful options.</p></li>
</ul>
</dd>
</dl>
<p>Each output is of the form:
((date, fly_num), (thorimage_dir&lt;i&gt;, thorsync_dir&lt;i&gt;))</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Generator</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Timestamp</span></code>, <code class="xref py py-func docutils literal notranslate"><span class="pre">NewType()</span></code>(<code class="xref py py-data docutils literal notranslate"><span class="pre">FlyNum</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>)], <code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code>]], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.parent_recording_id">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">parent_recording_id</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tiffname_or_thorimage_id</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#parent_recording_id"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.parent_recording_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns recording id for recording subrecording was derived from.</p>
<p>Input can be a TIFF filename or recording id.</p>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.pd_allclose">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">pd_allclose</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">if_index_mismatch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#pd_allclose"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.pd_allclose" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a|b</strong> – inputs to compare. must both be either DataFrames or Series.</p></li>
<li><p><strong>if_index_mismatch</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – passed to <cite>pd_indices_equal</cite></p></li>
<li><p><strong>**kwargs</strong> – passed thru to <cite>np.allclose</cite> (<cite>equal_nan=True</cite> may be the most useful)</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.pd_indices_equal">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">pd_indices_equal</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">if_index_mismatch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#pd_indices_equal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.pd_indices_equal" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a|b</strong> – inputs to compare. must both be either DataFrames or Series.</p></li>
<li><p><strong>if_index_mismatch</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – whether to return False (None), warn (and return False), or
raise ValueError if either row/column indices do not match</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.pd_isclose">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">pd_isclose</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#pd_isclose"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.pd_isclose" title="Permalink to this definition">¶</a></dt>
<dd><p>Like <cite>np.isclose</cite>, but preserves input indices.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a|b</strong> – inputs to compare. must both be either DataFrames or Series.</p></li>
<li><p><strong>**kwargs</strong> – passed thru to <cite>np.allclose</cite> (<cite>equal_nan=True</cite> may be the most useful)</p></li>
</ul>
</dd>
</dl>
<p>Raises ValueError if indices do not match.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.print_all_stimfile_odorsets">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">print_all_stimfile_odorsets</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#print_all_stimfile_odorsets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.print_all_stimfile_odorsets" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.print_block_frames">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">print_block_frames</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">block_first_frames</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">block_last_frames</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#print_block_frames"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.print_block_frames" title="Permalink to this definition">¶</a></dt>
<dd><p>Prints block numbers and the corresponding start / stop frames.</p>
<p>For subsetting TIFF in ImageJ / other manual analysis.</p>
<p>Prints frame numbers 1-indexed, but takes 0-indexed frames.</p>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.print_color">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">print_color</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">color_name</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#print_color"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.print_color" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="hong2p.util.print_thor_paths">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">print_thor_paths</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sync_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_full_paths</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#print_thor_paths"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.print_thor_paths" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.print_trial_odors">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">print_trial_odors</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">odor_onset_frames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#print_trial_odors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.print_trial_odors" title="Permalink to this definition">¶</a></dt>
<dd><p>data should be as the output of <cite>load_odor_metadata</cite></p>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.raw_data_root">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">raw_data_root</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">root</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#raw_data_root"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.raw_data_root" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.raw_fly_dir">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">raw_fly_dir</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fly</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">short</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#raw_fly_dir"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.raw_fly_dir" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>short</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – If True, returns in format YYYY-MM-DD/&lt;fly #&gt;/&lt;ThorImage dir&gt;, without
the prefix specifying the full path. Intended for creating more readable
paths, where absolute paths are not required.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.recording_df2keys">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">recording_df2keys</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#recording_df2keys"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.recording_df2keys" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="hong2p.util.set_data_root">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">set_data_root</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_data_root</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#set_data_root"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.set_data_root" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets data root, so future calls to <cite>data_root</cite> will return the input.</p>
<p>You may either use this function or set one of the environment variables
that the <cite>data_root</cite> function checks.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.shorten_path">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">shorten_path</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">full_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#shorten_path"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.shorten_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a string containing just the last <cite>n</cite> parts of input path.</p>
<p>For making IDs / easier-to-read paths, when the full path isn’t required.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.shorten_stimfile_path">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">shorten_stimfile_path</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stimfile_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stimfile_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#shorten_stimfile_path"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.shorten_stimfile_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Shortens absolute stimulus YAML path to one relative to stimfile_dir.</p>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.skipped_comparison_nums">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">skipped_comparison_nums</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#skipped_comparison_nums"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.skipped_comparison_nums" title="Permalink to this definition">¶</a></dt>
<dd><p>Requires at least recording_from and comparison columns.
Can also take prep_date, fly_num, and thorimage_id.</p>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.smooth_1d">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">smooth_1d</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hanning'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#smooth_1d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.smooth_1d" title="Permalink to this definition">¶</a></dt>
<dd><p>smooth the data using a window with requested size.</p>
<p>This method is based on the convolution of a scaled window with the signal.
The signal is prepared by introducing reflected copies of the signal
(with the window size) in both ends so that transient parts are minimized
in the begining and end part of the output signal.</p>
<dl>
<dt>input:</dt><dd><p>x: the input signal
window_len: the dimension of the smoothing window; should be an odd</p>
<blockquote>
<div><p>integer</p>
</div></blockquote>
<dl class="simple">
<dt>window: the type of window from ‘flat’, ‘hanning’, ‘hamming’,</dt><dd><p>‘bartlett’, ‘blackman’ flat window will produce a moving average
smoothing.</p>
</dd>
</dl>
</dd>
<dt>output:</dt><dd><p>the smoothed signal</p>
</dd>
</dl>
<p>example:</p>
<p>t=linspace(-2,2,0.1)
x=sin(t)+randn(len(t))*0.1
y=smooth_1d(x)</p>
<p>see also:</p>
<p>numpy.hanning, numpy.hamming, numpy.bartlett, numpy.blackman, numpy.convolve
scipy.signal.lfilter</p>
<p>TODO: the window parameter could be the window itself if an array instead of
a string
NOTE: length(output) != length(input), to correct this: return
y[(window_len/2-1):-(window_len/2)] instead of just y.</p>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.split_odor_w_conc">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">split_odor_w_conc</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">row_or_str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#split_odor_w_conc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.split_odor_w_conc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="hong2p.util.start_color">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">start_color</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">color_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#start_color"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.start_color" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="hong2p.util.stimfile_odorset">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">stimfile_odorset</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stimfile_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#stimfile_odorset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.stimfile_odorset" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="hong2p.util.stimfile_root">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">stimfile_root</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#stimfile_root"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.stimfile_root" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.stimulus_yaml_from_thorimage">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">stimulus_yaml_from_thorimage</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">thorimage_dir_or_xml</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stimfile_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#stimulus_yaml_from_thorimage"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.stimulus_yaml_from_thorimage" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns absolute path to stimulus YAML file from note field in ThorImage XML.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>thorimage_dir_or_xml</strong> – path to ThorImage output directory or XML Element
containing parsed contents of the corresponding Experiment.xml file.</p></li>
<li><p><strong>stimfile_dir</strong> (<em>str</em>) – (optional) directory containing stimulus .yaml files.
If not passed, <cite>stimfile_root()</cite> is used.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>TooManyStimulusFiles if multiple substrings of note field end with .yaml</strong> – </p></li>
<li><p><strong>NoStimulusFile if no substrings of note field end with .yaml</strong> – </p></li>
<li><p><strong>IOError if stimulus file directory does not exist</strong> – </p></li>
</ul>
</dd>
</dl>
<p>XML should contain a manually-entered path relative to where the olfactometer code
that generated it was run, but assuming it was copied to the appropriate location
(directly under <cite>stimfile_dir</cite> if passed or <cite>stimfile_root()</cite> otherwise), this
absolute path should exist.</p>
<p>My typical workflow is to paste this path into the ThorImage note field, while doing
the experiment. <cite>olf</cite> will automatically populate clipboard with this path, when
running the olfactometer program, to facilitate this.</p>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.stop_color">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">stop_color</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#stop_color"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.stop_color" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="hong2p.util.subrecording_tiff_blocks">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">subrecording_tiff_blocks</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tiff_filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#subrecording_tiff_blocks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.subrecording_tiff_blocks" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns tuple of int (start, stop) block numbers subrecording contains.</p>
<p>Block numbers start at 0.</p>
<p>Requires that is_subrecording_tiff(tiff_filename) would return True.</p>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.subrecording_tiff_blocks_df">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">subrecording_tiff_blocks_df</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">series</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#subrecording_tiff_blocks_df"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.subrecording_tiff_blocks_df" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a series w/ TIFF name in series.name to (start, stop) block nums.</p>
<p>(series.name must be a TIFF path)</p>
<p>Same behavior as <cite>subrecording_tiff_blocks</cite>.</p>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.subset_levels">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">subset_levels</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#subset_levels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.subset_levels" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Index</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.suffix_index_names">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">suffix_index_names</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suffix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'_b'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'columns'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#suffix_index_names"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.suffix_index_names" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.thor2tiff">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">thor2tiff</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image_dir</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_basename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">if_exists</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'err'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flip_lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">discard_channel_b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_round_trip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#thor2tiff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.thor2tiff" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts ThorImage .raw file to .tif file in same directory</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>if_exists</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – ‘load’, ‘ignore’, ‘overwrite’, or ‘err’</p></li>
<li><p><strong>flip_lr</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>]) – If True, flip the raw movie along the left/right axis, to make
experiments including both left/right side data more comparable.
If True/False, default output basename will be ‘flipped.tif’. If None,
default output basename will remain ‘raw.tif’.</p></li>
<li><p><strong>check_round_trip</strong> – If True, and a TIFF was written, read it and check it is equal
to data loaded from ThorImage raw.</p></li>
</ul>
</dd>
</dl>
<p>Returns an np.ndarray movie if TIFF was created OR if if_exists=’load’ and
the corresponding TIFF already exists. Returns None if if_exists=’ignore’ and the
corresponding TIFF already exists.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.thorimage2yaml_info_and_odor_lists">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">thorimage2yaml_info_and_odor_lists</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">thorimage_dir_or_xml</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stimfile_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#thorimage2yaml_info_and_odor_lists"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.thorimage2yaml_info_and_odor_lists" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns yaml_path, yaml_data, odor_lists</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>thorimage_dir_or_xml</strong> – path to ThorImage output directory or XML Element object
parsed from corresponding Experiment.xml file</p></li>
<li><p><strong>stimfile_dir</strong> (<em>str</em>) – (optional) directory containing stimulus .yaml files.
If not passed, <cite>stimfile_root()</cite> is used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>path to YAML</p>
<p>yaml_data (dict): loaded contents of <cite>yaml_path</cite></p>
<dl class="simple">
<dt>odor_lists (list-of-lists-of-dicts): each list this contains is a representation</dt><dd><p>of all the odors presented together on a given trial</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>yaml_path (str)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.thorimage_dir">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">thorimage_dir</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fly</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thorimage_id</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#thorimage_dir"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.thorimage_dir" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.thorimage_dir_input">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">thorimage_dir_input</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#thorimage_dir_input"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.thorimage_dir_input" title="Permalink to this definition">¶</a></dt>
<dd><p>Wraps functions taking ThorImage path and adds option to call via fly keys</p>
<p>Fly keys are (date, fly_num, thorimage_id)</p>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.thorsync_dir">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">thorsync_dir</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fly</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_thorsync_dir</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#thorsync_dir"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.thorsync_dir" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.tiff_filename2keys">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">tiff_filename2keys</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tiff_filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#tiff_filename2keys"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.tiff_filename2keys" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes TIFF filename to pd.Series w/ ‘date’,’fly_num’,’thorimage_id’ keys.</p>
<p>TIFF must be placed and named according to convention, because the
date and fly_num are taken from names of some of the containing directories.</p>
<p>Works with TIFFs either under <cite>raw_data_root</cite> or <cite>analysis_output_root</cite>.</p>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.tiff_ijroi_filename">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">tiff_ijroi_filename</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tiff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">confirm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gui_confirm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gui_fallback</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gui</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'qt5'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#tiff_ijroi_filename"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.tiff_ijroi_filename" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a tiff path to corresponding ImageJ ROI file, assuming a certain
naming convention and folder structure.</p>
<p>Automatic search for ROI will only check same folder as the TIFF passed in.</p>
<p>Options for fallback to manual selection / confirmation of appropriate
ROI file.</p>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.tiff_thorimage_id">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">tiff_thorimage_id</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tiff_filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#tiff_thorimage_id"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.tiff_thorimage_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a path to a TIFF and returns ID to identify recording within
(date, fly). Relies on naming convention.</p>
<p>Works for input that is either a raw TIFF or a motion corrected TIFF,
the latter of which should have a conventional suffix indicating the
type of motion correction (‘_nr’ / ‘_rig’).</p>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.tiff_title">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">tiff_title</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tif</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#tiff_title"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.tiff_title" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns abbreviation of TIFF filename for use in titles.</p>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.to_filename">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">to_filename</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_remove_chars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#to_filename"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.to_filename" title="Permalink to this definition">¶</a></dt>
<dd><p>Take a str and normalizes it a bit to make it a better filename prefix.</p>
<p>E.g. taking a plot title and using it to derive a filename for saving the
plot.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.u8_color">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">u8_color</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">draw_on</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#u8_color"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.u8_color" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="hong2p.util.version_info">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">version_info</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">used_for</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_git</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#version_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.version_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes module or string path to file in Git repo to a dict with version
information (with keys and values the database will accept).</p>
</dd></dl>

<dl class="py function">
<dt id="hong2p.util.write_tiff">
<code class="sig-prename descclassname"><span class="pre">hong2p.util.</span></code><code class="sig-name descname"><span class="pre">write_tiff</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tiff_filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">movie</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strict_dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/util.html#write_tiff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.util.write_tiff" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a TIFF loading the same as the TIFFs we create with ImageJ.</p>
<p>TIFFs are written in big-endian byte order to be readable by <cite>imread_big</cite>
from MATLAB file exchange.</p>
<p>Dimensions of input should be (t,[z,],y,x).</p>
<p>Metadata may not be correct.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dims</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – may or may not have the same meaning as <cite>tifffile.imsave</cite> <cite>axes</cite> kwarg</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="hong2p.viz.html" class="btn btn-neutral float-right" title="hong2p.viz module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="hong2p.types.html" class="btn btn-neutral float-left" title="hong2p.types module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2022, Tom O&#39;Connell.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>