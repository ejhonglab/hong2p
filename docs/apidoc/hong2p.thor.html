<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>hong2p.thor module &mdash; hong2p 0.0.0 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="hong2p.types module" href="hong2p.types.html" />
    <link rel="prev" title="hong2p.suite2p module" href="hong2p.suite2p.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> hong2p
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">hong2p</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="hong2p.html">hong2p package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="hong2p.html#submodules">Submodules</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="hong2p.olf.html">hong2p.olf module</a></li>
<li class="toctree-l4"><a class="reference internal" href="hong2p.suite2p.html">hong2p.suite2p module</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">hong2p.thor module</a></li>
<li class="toctree-l4"><a class="reference internal" href="hong2p.types.html">hong2p.types module</a></li>
<li class="toctree-l4"><a class="reference internal" href="hong2p.util.html">hong2p.util module</a></li>
<li class="toctree-l4"><a class="reference internal" href="hong2p.viz.html">hong2p.viz module</a></li>
<li class="toctree-l4"><a class="reference internal" href="hong2p.xarray.html">hong2p.xarray module</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="hong2p.html#module-hong2p">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">hong2p</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="modules.html">hong2p</a> &raquo;</li>
          <li><a href="hong2p.html">hong2p package</a> &raquo;</li>
      <li>hong2p.thor module</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/apidoc/hong2p.thor.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-hong2p.thor">
<span id="hong2p-thor-module"></span><h1>hong2p.thor module<a class="headerlink" href="#module-hong2p.thor" title="Permalink to this heading"></a></h1>
<p>Functions for working with ThorImage / ThorSync outputs, including for dealing
with naming conventions we use for outputs of these programs.</p>
<dl class="py function">
<dt class="sig sig-object py" id="hong2p.thor.assign_frame_times_to_blocks">
<span class="sig-prename descclassname"><span class="pre">hong2p.thor.</span></span><span class="sig-name descname"><span class="pre">assign_frame_times_to_blocks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frame_times</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rtol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/thor.html#assign_frame_times_to_blocks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.thor.assign_frame_times_to_blocks" title="Permalink to this definition"></a></dt>
<dd><p>Takes array of frame times to (start, stop) indices for each block.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>frame_times</strong> (<em>np.array</em>) – as output by <cite>get_frame_times</cite>.
should have a <cite>shape</cite> of <cite>(movie.shape[0],)</cite>.</p></li>
<li><p><strong>rtol</strong> (<em>float</em>) – (optional, default=1.5) time differences between frames must
be at least this multiplied by the median time difference in order for
a block to be called there.</p></li>
</ul>
</dd>
</dl>
<p>Notes:
This function defines blocks (periods of continuous acquisition) by regions
of <cite>frame_times</cite> where the time difference between frames remains
essentially constant. Large jumps in the time between two frames defines the
start of a new block. Indices returned would be suitable to index the first
dimension of the <cite>movie</cite>, the output of <cite>get_frame_times</cite>, etc. <cite>stop</cite>
indices are included as part of the block, so you should add one when using
them as the end of a slice.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hong2p.thor.assign_frames_to_blocks">
<span class="sig-prename descclassname"><span class="pre">hong2p.thor.</span></span><span class="sig-name descname"><span class="pre">assign_frames_to_blocks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thorimage_dir</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/thor.html#assign_frames_to_blocks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.thor.assign_frames_to_blocks" title="Permalink to this definition"></a></dt>
<dd><p>Takes ThorSync+Image data to (start, stop) indices for each block.</p>
<p>Args:
df (DataFrame): as output by <cite>load_thorsync_hdf5</cite></p>
<p>thorimage_dir (str): path to a directory created by ThorImage</p>
<p>kwargs (dict): passed through to <cite>get_frame_times</cite></p>
<p>See documentation of <cite>assign_frame_times_to_blocks</cite> for more details on the
definition of blocks and the properties of the output.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hong2p.thor.assign_frames_to_odor_presentations">
<span class="sig-prename descclassname"><span class="pre">hong2p.thor.</span></span><span class="sig-name descname"><span class="pre">assign_frames_to_odor_presentations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">thorsync_input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thorimage_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">odor_onset_to_frame_rel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">odor_onset_to_frame_const</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">odor_timing_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_all_frames_assigned</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_no_discontinuity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/thor.html#assign_frames_to_odor_presentations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.thor.assign_frames_to_odor_presentations" title="Permalink to this definition"></a></dt>
<dd><p>Returns list of (start, first_odor_frame, end) frame indices</p>
<p>One 3-tuple per odor presentation.</p>
<p>Frames are indexed as they are along the first dimension of the movie,
including for volumetric data (where a scalar index of this dimension will
produce a volume) and/or data collected via frame averaging.</p>
<p>End frames are included in range, and thus getting a presentation must be
done like <cite>movie[start_i:(end_i + 1)]</cite> rather  than <cite>movie[start_i:end_i]</cite>.</p>
<p>Not all frames necessarily included. No overlap.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>thorsync_input</strong> (<em>str</em><em> | </em><em>pd.DataFrame</em>) – path to directory created by ThorSync
or a dataframe as would be created by passing such a directory to
<cite>load_thorsync_hdf5</cite>.</p></li>
<li><p><strong>thorimage_dir</strong> (<em>str</em>) – path to directory created by ThorImage that corresponds
to the same experiment as the ThorSync data in <cite>thorsync_input</cite>.</p></li>
<li><p><strong>odor_onset_to_frame_rel</strong> (<em>float</em>) – <p>(NOT IMPLEMENTED) factor of averaged
volumes/frames per second used to determine how long after odor onset to
call first odor frame.</p>
<p>No first odor frames will be before: (odor onset time +
odor_onset_to_frame_rel * averaged volumes/frames per second +
odor_onset_to_frame_const)</p>
</p></li>
<li><p><strong>odor_onset_to_frame_const</strong> (<em>float</em>) – (NOT IMPLEMENTED) seconds after odor onset to
call first odor frame. mainly to compensate for known lag between valve
opening and odor arriving at the animal.</p></li>
<li><p><strong>**kwargs</strong> – passed through to <cite>get_frame_times</cite>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hong2p.thor.cnmf_metadata_from_thor">
<span class="sig-prename descclassname"><span class="pre">hong2p.thor.</span></span><span class="sig-name descname"><span class="pre">cnmf_metadata_from_thor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/thor.html#cnmf_metadata_from_thor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.thor.cnmf_metadata_from_thor" title="Permalink to this definition"></a></dt>
<dd><p>Takes TIF filename to key settings from XML needed for CNMF.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hong2p.thor.find_last_true">
<span class="sig-prename descclassname"><span class="pre">hong2p.thor.</span></span><span class="sig-name descname"><span class="pre">find_last_true</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/thor.html#find_last_true"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.thor.find_last_true" title="Permalink to this definition"></a></dt>
<dd><p>Returns the index of the last <cite>True</cite> in 1-dimensional <cite>x</cite>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hong2p.thor.fps_from_thor">
<span class="sig-prename descclassname"><span class="pre">hong2p.thor.</span></span><span class="sig-name descname"><span class="pre">fps_from_thor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/thor.html#fps_from_thor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.thor.fps_from_thor" title="Permalink to this definition"></a></dt>
<dd><p>Takes a DataFrame and returns fps from ThorImage XML.</p>
<p>df must have a ‘thorimage_dir’ column (that can be either a relative or
absolute path, as long as it’s under raw_data_root), which is expected to
only contain one unique value.</p>
<p>Only the path in the first row is used.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hong2p.thor.get_col_onset_indices">
<span class="sig-prename descclassname"><span class="pre">hong2p.thor.</span></span><span class="sig-name descname"><span class="pre">get_col_onset_indices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">possible_col_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/thor.html#get_col_onset_indices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.thor.get_col_onset_indices" title="Permalink to this definition"></a></dt>
<dd><p>Returns arrays onsets, offsets with appropriate indices in <cite>df</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>possible_col_names</strong> (<em>str</em><em> or </em><em>tuple</em>) – can be either exact column name in
<cite>df</cite> or an iterable of column names, where the first matching a column
in <cite>df</cite> will be used.</p></li>
<li><p><strong>**kwargs</strong> – passed through to <cite>threshold_crossings</cite>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hong2p.thor.get_col_onset_offset_indices">
<span class="sig-prename descclassname"><span class="pre">hong2p.thor.</span></span><span class="sig-name descname"><span class="pre">get_col_onset_offset_indices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">possible_col_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/thor.html#get_col_onset_offset_indices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.thor.get_col_onset_offset_indices" title="Permalink to this definition"></a></dt>
<dd><p>Returns arrays onsets, offsets with appropriate indices in <cite>df</cite>.</p>
<dl class="simple">
<dt>possible_col_names (str or tuple): can be either exact column name in</dt><dd><p><cite>df</cite> or an iterable of column names, where the first matching a column
in <cite>df</cite> will be used.</p>
</dd>
</dl>
<p>threshold (float): passed to <cite>threshold_crossings</cite> under the same name.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hong2p.thor.get_col_onset_offset_times">
<span class="sig-prename descclassname"><span class="pre">hong2p.thor.</span></span><span class="sig-name descname"><span class="pre">get_col_onset_offset_times</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">possible_col_names</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/thor.html#get_col_onset_offset_times"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.thor.get_col_onset_offset_times" title="Permalink to this definition"></a></dt>
<dd><p>Returns arrays onsets, offsets with appropriate values from <cite>df.time_s</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>DataFrame</em>) – must have a column <cite>‘time_s’</cite>, as generated by
<cite>load_thorsync_hdf5</cite>.</p></li>
<li><p><strong>possible_col_names</strong> (<em>str</em><em> or </em><em>tuple</em>) – can be either exact column name in
<cite>df</cite> or an iterable of column names, where the first matching a column
in <cite>df</cite> will be used.</p></li>
<li><p><strong>**kwargs</strong> – passed to <cite>get_col_onset_offset_indices</cite></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hong2p.thor.get_flyback_indices">
<span class="sig-prename descclassname"><span class="pre">hong2p.thor.</span></span><span class="sig-name descname"><span class="pre">get_flyback_indices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_frames</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_flyback</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">series</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/thor.html#get_flyback_indices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.thor.get_flyback_indices" title="Permalink to this definition"></a></dt>
<dd><p>Returns indices of XY frames during piezo flyback, or empty array if none</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hong2p.thor.get_frame_times">
<span class="sig-prename descclassname"><span class="pre">hong2p.thor.</span></span><span class="sig-name descname"><span class="pre">get_frame_times</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thorimage_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_ref</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mid'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_block_duration_s</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acquisition_trigger_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_wont_use_df_after</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/thor.html#get_frame_times"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.thor.get_frame_times" title="Permalink to this definition"></a></dt>
<dd><p>Returns seconds from start of ThorSync recording for each frame.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<cite>DataFrame</cite>) – as returned by <cite>load_thorsync_hdf5</cite></p></li>
<li><p><strong>thorimage_dir</strong> (<em>str</em>) – path to ThorImage directory to load metadata from</p></li>
<li><p><strong>time_ref</strong> (<em>'mid'</em><em> | </em><em>'end'</em>) – </p></li>
<li><p><strong>min_block_duration_s</strong> (<em>float</em>) – (default=1.0) minimum time (in seconds) between
onset and offset of acquisition trigger. Shorter blocks that precede all
acceptable-length blocks will simply be disregarding, with a warning.
Shorter blocks following any acceptable-length blocks will currently trigger
an error.</p></li>
</ul>
</dd>
</dl>
<p>Returns a <cite>np.array</cite> that should be of length equal to the number of frames
actually saved by ThorImage (i.e. <cite>&lt;output&gt;.shape</cite> should be equal to
<cite>(movie.shape[0],)</cite>).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hong2p.thor.get_thorimage_dims">
<span class="sig-prename descclassname"><span class="pre">hong2p.thor.</span></span><span class="sig-name descname"><span class="pre">get_thorimage_dims</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xml</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/thor.html#get_thorimage_dims"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.thor.get_thorimage_dims" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hong2p.thor.get_thorimage_dims_xml">
<span class="sig-prename descclassname"><span class="pre">hong2p.thor.</span></span><span class="sig-name descname"><span class="pre">get_thorimage_dims_xml</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xml</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/thor.html#get_thorimage_dims_xml"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.thor.get_thorimage_dims_xml" title="Permalink to this definition"></a></dt>
<dd><p>Takes etree XML root object to (xy, z, c) dimensions of movie.</p>
<p>XML object should be as returned by <cite>get_thorimage_xmlroot</cite>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hong2p.thor.get_thorimage_fps">
<span class="sig-prename descclassname"><span class="pre">hong2p.thor.</span></span><span class="sig-name descname"><span class="pre">get_thorimage_fps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">thorimage_directory</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/thor.html#get_thorimage_fps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.thor.get_thorimage_fps" title="Permalink to this definition"></a></dt>
<dd><p>Takes ThorImage dir to fps of recording.</p>
<dl class="simple">
<dt>before_averaging (bool): (default=False) pass True to return the fps before</dt><dd><p>any averaging.</p>
</dd>
</dl>
<p>All <cite>kwargs</cite> are passed through to <cite>get_thorimage_fps_xml</cite>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hong2p.thor.get_thorimage_fps_xml">
<span class="sig-prename descclassname"><span class="pre">hong2p.thor.</span></span><span class="sig-name descname"><span class="pre">get_thorimage_fps_xml</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xml</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">before_averaging</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/thor.html#get_thorimage_fps_xml"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.thor.get_thorimage_fps_xml" title="Permalink to this definition"></a></dt>
<dd><p>Takes XML root object to fps of recording.</p>
<p>xml: etree XML root object as returned by <cite>get_thorimage_xmlroot</cite>.</p>
<dl class="simple">
<dt>before_averaging (bool): (default=False) pass True to return the fps before</dt><dd><p>any averaging.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hong2p.thor.get_thorimage_n_averaged_frames_xml">
<span class="sig-prename descclassname"><span class="pre">hong2p.thor.</span></span><span class="sig-name descname"><span class="pre">get_thorimage_n_averaged_frames_xml</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xml</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/thor.html#get_thorimage_n_averaged_frames_xml"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.thor.get_thorimage_n_averaged_frames_xml" title="Permalink to this definition"></a></dt>
<dd><p>Returns how many frames ThorImage averaged for a single output frame.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hong2p.thor.get_thorimage_n_channels_xml">
<span class="sig-prename descclassname"><span class="pre">hong2p.thor.</span></span><span class="sig-name descname"><span class="pre">get_thorimage_n_channels_xml</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xml</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/thor.html#get_thorimage_n_channels_xml"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.thor.get_thorimage_n_channels_xml" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hong2p.thor.get_thorimage_n_flyback_xml">
<span class="sig-prename descclassname"><span class="pre">hong2p.thor.</span></span><span class="sig-name descname"><span class="pre">get_thorimage_n_flyback_xml</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xml</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/thor.html#get_thorimage_n_flyback_xml"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.thor.get_thorimage_n_flyback_xml" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hong2p.thor.get_thorimage_n_frames">
<span class="sig-prename descclassname"><span class="pre">hong2p.thor.</span></span><span class="sig-name descname"><span class="pre">get_thorimage_n_frames</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xml</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">without_flyback</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_volumes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/thor.html#get_thorimage_n_frames"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.thor.get_thorimage_n_frames" title="Permalink to this definition"></a></dt>
<dd><p>Returns the number of XY planes (# of timepoints) in the recording.</p>
<p>This is the number of frames <em>after</em> any averaging configured in ThorImage.</p>
<p>Any flyback frames are included.</p>
<p>If additional color channels are enabled but other parameters remain the same, this
number will not change.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>without_flyback</strong> – if True, subtract the number of flyback frames (if any)</p></li>
<li><p><strong>num_volumes</strong> – if True, return number of volumes instead of number of XY frames.
since there are a fixed number of flyback frames per volume, this option
will return the same number regardless of without_flyback.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hong2p.thor.get_thorimage_name">
<span class="sig-prename descclassname"><span class="pre">hong2p.thor.</span></span><span class="sig-name descname"><span class="pre">get_thorimage_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xml</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/thor.html#get_thorimage_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.thor.get_thorimage_name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hong2p.thor.get_thorimage_notes">
<span class="sig-prename descclassname"><span class="pre">hong2p.thor.</span></span><span class="sig-name descname"><span class="pre">get_thorimage_notes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xml</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/thor.html#get_thorimage_notes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.thor.get_thorimage_notes" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hong2p.thor.get_thorimage_pixelsize_xml">
<span class="sig-prename descclassname"><span class="pre">hong2p.thor.</span></span><span class="sig-name descname"><span class="pre">get_thorimage_pixelsize_xml</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xml</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/thor.html#get_thorimage_pixelsize_xml"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.thor.get_thorimage_pixelsize_xml" title="Permalink to this definition"></a></dt>
<dd><p>Takes etree XML root object to XY pixel size in um.</p>
<p>Pixel size in X is the same as pixel size in Y.</p>
<p>XML object should be as returned by <cite>get_thorimage_xmlroot</cite>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hong2p.thor.get_thorimage_time">
<span class="sig-prename descclassname"><span class="pre">hong2p.thor.</span></span><span class="sig-name descname"><span class="pre">get_thorimage_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">thorimage_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_mtime</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/thor.html#get_thorimage_time"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.thor.get_thorimage_time" title="Permalink to this definition"></a></dt>
<dd><p>Takes ThorImage directory to recording start time (from XML).</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">datetime</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hong2p.thor.get_thorimage_time_xml">
<span class="sig-prename descclassname"><span class="pre">hong2p.thor.</span></span><span class="sig-name descname"><span class="pre">get_thorimage_time_xml</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xml</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/thor.html#get_thorimage_time_xml"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.thor.get_thorimage_time_xml" title="Permalink to this definition"></a></dt>
<dd><p>Takes etree XML root object to recording start time.</p>
<p>XML object should be as returned by <cite>get_thorimage_xmlroot</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">datetime</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hong2p.thor.get_thorimage_xml_path">
<span class="sig-prename descclassname"><span class="pre">hong2p.thor.</span></span><span class="sig-name descname"><span class="pre">get_thorimage_xml_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">thorimage_dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/thor.html#get_thorimage_xml_path"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.thor.get_thorimage_xml_path" title="Permalink to this definition"></a></dt>
<dd><p>Takes ThorImage output dir to (expected) path to its XML output.</p>
<p>Raises IOError if either thorimage_dir or Experiment.xml contained within it do not
exist.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hong2p.thor.get_thorimage_xmlroot">
<span class="sig-prename descclassname"><span class="pre">hong2p.thor.</span></span><span class="sig-name descname"><span class="pre">get_thorimage_xmlroot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">thorimage_dir_or_xmlroot</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/thor.html#get_thorimage_xmlroot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.thor.get_thorimage_xmlroot" title="Permalink to this definition"></a></dt>
<dd><p>Takes ThorImage output dir to object w/ XML data.</p>
<p>Returns the input without doing anything if it is already the same type of XML
object that would be returned, to allow writing functions that can either be given
paths to ThorImage directories or re-use an already loaded representation of its
XML.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Element</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hong2p.thor.get_thorimage_z_xml">
<span class="sig-prename descclassname"><span class="pre">hong2p.thor.</span></span><span class="sig-name descname"><span class="pre">get_thorimage_z_xml</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xml</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/thor.html#get_thorimage_z_xml"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.thor.get_thorimage_z_xml" title="Permalink to this definition"></a></dt>
<dd><p>Returns number of different Z depths measured in ThorImage recording.</p>
<p>Does NOT include any flyback frames there may be.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hong2p.thor.get_thorsync_h5">
<span class="sig-prename descclassname"><span class="pre">hong2p.thor.</span></span><span class="sig-name descname"><span class="pre">get_thorsync_h5</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">thorsync_dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/thor.html#get_thorsync_h5"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.thor.get_thorsync_h5" title="Permalink to this definition"></a></dt>
<dd><p>Returns path to ThorSync .h5 output given a directory created by ThorSync</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hong2p.thor.get_thorsync_samplerate_hz">
<span class="sig-prename descclassname"><span class="pre">hong2p.thor.</span></span><span class="sig-name descname"><span class="pre">get_thorsync_samplerate_hz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">thorsync_dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/thor.html#get_thorsync_samplerate_hz"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.thor.get_thorsync_samplerate_hz" title="Permalink to this definition"></a></dt>
<dd><p>Returns int sample rate (Hz) of ThorSync HDF5 data in <cite>thorsync_dir</cite>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hong2p.thor.get_thorsync_time">
<span class="sig-prename descclassname"><span class="pre">hong2p.thor.</span></span><span class="sig-name descname"><span class="pre">get_thorsync_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">thorsync_dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/thor.html#get_thorsync_time"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.thor.get_thorsync_time" title="Permalink to this definition"></a></dt>
<dd><p>Returns modification time of ThorSync XML.</p>
<p>Not perfect, but it doesn’t seem any ThorSync outputs have timestamps.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hong2p.thor.get_thorsync_xml_path">
<span class="sig-prename descclassname"><span class="pre">hong2p.thor.</span></span><span class="sig-name descname"><span class="pre">get_thorsync_xml_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">thorsync_dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/thor.html#get_thorsync_xml_path"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.thor.get_thorsync_xml_path" title="Permalink to this definition"></a></dt>
<dd><p>Takes ThorSync output dir to (expected) path to its XML output.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hong2p.thor.is_fast_z_enabled_xml">
<span class="sig-prename descclassname"><span class="pre">hong2p.thor.</span></span><span class="sig-name descname"><span class="pre">is_fast_z_enabled_xml</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xml</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/thor.html#is_fast_z_enabled_xml"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.thor.is_fast_z_enabled_xml" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hong2p.thor.is_thorimage_dir">
<span class="sig-prename descclassname"><span class="pre">hong2p.thor.</span></span><span class="sig-name descname"><span class="pre">is_thorimage_dir</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/thor.html#is_thorimage_dir"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.thor.is_thorimage_dir" title="Permalink to this definition"></a></dt>
<dd><p>True if dir has expected ThorImage outputs, False otherwise.</p>
<p>Looks for .raw not any TIFFs now.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hong2p.thor.is_thorimage_raw">
<span class="sig-prename descclassname"><span class="pre">hong2p.thor.</span></span><span class="sig-name descname"><span class="pre">is_thorimage_raw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/thor.html#is_thorimage_raw"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.thor.is_thorimage_raw" title="Permalink to this definition"></a></dt>
<dd><p>True if filename indicates file is ThorImage raw output.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hong2p.thor.is_thorsync_dir">
<span class="sig-prename descclassname"><span class="pre">hong2p.thor.</span></span><span class="sig-name descname"><span class="pre">is_thorsync_dir</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/thor.html#is_thorsync_dir"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.thor.is_thorsync_dir" title="Permalink to this definition"></a></dt>
<dd><p>True if dir has expected ThorSync outputs, False otherwise.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hong2p.thor.is_thorsync_h5">
<span class="sig-prename descclassname"><span class="pre">hong2p.thor.</span></span><span class="sig-name descname"><span class="pre">is_thorsync_h5</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/thor.html#is_thorsync_h5"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.thor.is_thorsync_h5" title="Permalink to this definition"></a></dt>
<dd><p>True if filename indicates file is ThorSync HDF5 output.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hong2p.thor.load_thorimage_metadata">
<span class="sig-prename descclassname"><span class="pre">hong2p.thor.</span></span><span class="sig-name descname"><span class="pre">load_thorimage_metadata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">thorimage_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_xml</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/thor.html#load_thorimage_metadata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.thor.load_thorimage_metadata" title="Permalink to this definition"></a></dt>
<dd><p>Returns (fps, xy, z, c, n_flyback, raw_output_path) for ThorImage dir.</p>
<p>Returns xml as an additional final return value if <cite>return_xml</cite> is True.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hong2p.thor.load_thorsync_hdf5">
<span class="sig-prename descclassname"><span class="pre">hong2p.thor.</span></span><span class="sig-name descname"><span class="pre">load_thorsync_hdf5</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">thorsync_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">datasets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_datasets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_gctr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_dataset_names_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_dict_rename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_normalization</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rename_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_tqdm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/thor.html#load_thorsync_hdf5"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.thor.load_thorsync_hdf5" title="Permalink to this definition"></a></dt>
<dd><p>Loads ThorSync .h5 output within <cite>thorsync_dir</cite> into a <cite>pd.DataFrame</cite></p>
<p>A column ‘time_s’ will be added, which is derived from ‘GCtr’, and
represents the time (in seconds) from the start of the ThorSync recording.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>datasets</strong> (<em>iterable of str</em><em> | </em><em>None</em>) – Load only datasets with these names.
Do not include the group names preceding the dataset name. Pass only
one of either this or <cite>exclude_datasets</cite>. Names are checked after any
renaming via <cite>rename_dict</cite> or normalization.</p></li>
<li><p><strong>exclude_datasets</strong> (<em>iterable of str</em><em> | </em><em>False</em><em> | </em><em>None</em>) – Load only datasets <em>except</em>
those with these names. Do not include ‘gctr’ here. Defaults to
<cite>hdf5_default_exclude_datasets</cite> if neither this nor <cite>datasets</cite> is passed.
If <cite>False</cite>, all datasets are loaded.</p></li>
<li><p><strong>drop_gctr</strong> (<em>bool</em>) – (default=True) Drop ‘/Global/GCtr’ data (would be returned
as column ‘gctr’) after using it to calculate ‘time_s’ column.</p></li>
<li><p><strong>rename_dict</strong> (<em>None</em><em> or </em><em>dict</em>) – (default=None) a dict of original-&gt;new name. If
not passed, <cite>hdf5_dataset_rename_dict</cite> is used. Applied before any
further operations on the column (dataset) names.</p></li>
</ul>
</dd>
</dl>
<p>These HDF5 files have the following hierarchical structure, where leaves of
this tree are “Datasets” and their parents are “Groups” (via inspection of a
ThorSync 3.0 output):
- Global:</p>
<blockquote>
<div><ul>
<li><p>GCtr
(from ThorSync 3.0 manual) “ThorSync records data into a table with
clock cycles beginning with 0.  The time of acquisition can be
determined by dividing the clock cycle by the frequency of the data
collection set at 20 MHz. Thus, each sequential clock cycle represents
an increment of 0.05 μs.”</p>
<p>Note that this 20 MHz is not the same as the sampling rate specified in
the ThorSync XML output. See commented example at end of this function.</p>
</li>
</ul>
</div></blockquote>
<ul>
<li><p>DI:
- Frame In</p>
<blockquote>
<div><ul class="simple">
<li><p>completely zero in the file I was exploring</p></li>
</ul>
</div></blockquote>
<ul>
<li><p>Frame Out
- may have one high pulse (==2 for some reason; low==0) per frame
- seems to only be low briefly before returning high again. perhaps just</p>
<blockquote>
<div><p>for one / a few samples?</p>
</div></blockquote>
<ul class="simple">
<li><p>it may be possible there are cases where there are more high pulses
here than there are frames in the movie, perhaps in cases with
averaging or multiple separate acquisition periods.</p></li>
</ul>
</li>
</ul>
</li>
<li><p>CI:
- Frame Counter</p></li>
<li><p>AI:
- &lt;one entry for each user-configured analog input&gt;</p></li>
</ul>
<p>Three changes will be made in translating HDF5 dataset names to DataFrame
column names:
1. If any dataset name is in the keys of <cite>rename_dict</cite>, it will be replaced</p>
<blockquote>
<div><p>with the corresponding value, unless <cite>skip_dict_rename</cite> is passed.</p>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>Names <em>except</em> those under the group ‘AI’ (mostly user configurable
inputs) will be lowercased, unless <cite>skip_normalization</cite> is passed.</p></li>
<li><p>All names will have any spaces converted to underscores, unless
<cite>skip_normalization</cite> is passed.</p></li>
</ol>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hong2p.thor.new_fmt_thorimage_num">
<span class="sig-prename descclassname"><span class="pre">hong2p.thor.</span></span><span class="sig-name descname"><span class="pre">new_fmt_thorimage_num</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/thor.html#new_fmt_thorimage_num"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.thor.new_fmt_thorimage_num" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hong2p.thor.old_fmt_thorimage_num">
<span class="sig-prename descclassname"><span class="pre">hong2p.thor.</span></span><span class="sig-name descname"><span class="pre">old_fmt_thorimage_num</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/thor.html#old_fmt_thorimage_num"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.thor.old_fmt_thorimage_num" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hong2p.thor.pair_thor_dirs">
<span class="sig-prename descclassname"><span class="pre">hong2p.thor.</span></span><span class="sig-name descname"><span class="pre">pair_thor_dirs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">thorimage_dirs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thorsync_dirs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_mtime</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_ranking</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_against_naming_conv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_unique_thorimage_nums</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_prepairing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/thor.html#pair_thor_dirs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.thor.pair_thor_dirs" title="Permalink to this definition"></a></dt>
<dd><p>Takes lists (not necessarily same len) of dirs, and returns a list of
lists of matching (ThorImage, ThorSync) dirs (sorted by experiment time).</p>
<p>Args:
check_against_naming_conv (bool): (default=False) If True, check ordering</p>
<blockquote>
<div><p>from pairing is consistent with ordering derived from our naming
conventions for Thor software output.</p>
</div></blockquote>
<dl class="simple">
<dt>check_unique_thorimage_nums (bool): If True, check numbers parsed from</dt><dd><p>ThorImage directory names, as-per convention, are unique.
Requires check_against_naming_conv to be True. Defaults to True if
check_against_naming_conv is True, else defaults to False.</p>
</dd>
<dt>ignore_prepairing (None | iterable of str): An optional iterable of substrings. If</dt><dd><p>any are present in the name of a Thor directory, that directory will be excluded
from consideration in pairing. This is mainly to keep the (fragile)
implementation that requires equal numbers of ThorImage and ThorSync directories
for pairing working if some particular experiments named a certain way only have
data from one. Will also be try appending these to <cite>ignore</cite> if uneven numbers of
directories and <cite>use_ranking=True</cite>.</p>
</dd>
<dt>ignore (None | iterable of str): As <cite>ignore_prepairing</cite>, but ignore will happen</dt><dd><p>after pairing. Both the ThorImage and ThorSync directories of a pair will be
checked for these substrings and if any match the pair is not returned. This is
mainly intended to ignore known-bad data.</p>
</dd>
</dl>
<p>Raises ValueError if two dirs of one type match to the same one of the
other, but just returns shorter list of pairs if some matches can not be
made. These errors currently just cause skipping of pairing for the
particular (date, fly) pair above (though maybe this should change?).</p>
<p>Raises AssertionError when assumptions are violated in a way that should
trigger re-evaluating the code.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code>]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hong2p.thor.pair_thor_subdirs">
<span class="sig-prename descclassname"><span class="pre">hong2p.thor.</span></span><span class="sig-name descname"><span class="pre">pair_thor_subdirs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parent_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/thor.html#pair_thor_subdirs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.thor.pair_thor_subdirs" title="Permalink to this definition"></a></dt>
<dd><p>Raises ValueError/AssertionError when pair_thor_dirs does.</p>
<p>Above, the former causes skipping of automatic pairing, whereas the latter
is not handled and will intentionally cause failure, to prevent incorrect
assumptions from leading to incorrect results.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code>]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hong2p.thor.read_movie">
<span class="sig-prename descclassname"><span class="pre">hong2p.thor.</span></span><span class="sig-name descname"><span class="pre">read_movie</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">thorimage_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">discard_flyback</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">discard_channel_b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/thor.html#read_movie"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.thor.read_movie" title="Permalink to this definition"></a></dt>
<dd><p>Returns (t,[z,]y,x) indexed timeseries as a numpy array.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hong2p.thor.thor_subdirs">
<span class="sig-prename descclassname"><span class="pre">hong2p.thor.</span></span><span class="sig-name descname"><span class="pre">thor_subdirs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parent_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">absolute_paths</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/thor.html#thor_subdirs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.thor.thor_subdirs" title="Permalink to this definition"></a></dt>
<dd><p>Returns a length-2 tuple, where the first element is all ThorImage children
and the second element is all ThorSync children (of <cite>parent_dir</cite>).</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code>]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hong2p.thor.thorimage_subdirs">
<span class="sig-prename descclassname"><span class="pre">hong2p.thor.</span></span><span class="sig-name descname"><span class="pre">thorimage_subdirs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parent_dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/thor.html#thorimage_subdirs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.thor.thorimage_subdirs" title="Permalink to this definition"></a></dt>
<dd><p>Returns a list of any immediate child directories of <cite>parent_dir</cite> that have
all expected ThorImage outputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hong2p.thor.thorimage_xml">
<span class="sig-prename descclassname"><span class="pre">hong2p.thor.</span></span><span class="sig-name descname"><span class="pre">thorimage_xml</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn_taking_xml</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/thor.html#thorimage_xml"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.thor.thorimage_xml" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hong2p.thor.thorsync_num">
<span class="sig-prename descclassname"><span class="pre">hong2p.thor.</span></span><span class="sig-name descname"><span class="pre">thorsync_num</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">thorsync_dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/thor.html#thorsync_num"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.thor.thorsync_num" title="Permalink to this definition"></a></dt>
<dd><p>Returns number in suffix of ThorSync output directory name as an int.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hong2p.thor.thorsync_subdirs">
<span class="sig-prename descclassname"><span class="pre">hong2p.thor.</span></span><span class="sig-name descname"><span class="pre">thorsync_subdirs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parent_dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/thor.html#thorsync_subdirs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.thor.thorsync_subdirs" title="Permalink to this definition"></a></dt>
<dd><p>Returns a list of any immediate child directories of <cite>parent_dir</cite>
that have all expected ThorSync outputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hong2p.thor.threshold_crossings">
<span class="sig-prename descclassname"><span class="pre">hong2p.thor.</span></span><span class="sig-name descname"><span class="pre">threshold_crossings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">signal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">onsets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offsets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/thor.html#threshold_crossings"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.thor.threshold_crossings" title="Permalink to this definition"></a></dt>
<dd><p>Returns indices where signal goes from &lt; threshold to &gt; threshold as onsets,
and where signal goes from &gt; threshold to &lt; threshold as offsets.</p>
<p>Cases where it at one index equals the threshold are ignored. Shouldn’t
happen and may indicate electrical problems for our application.</p>
<p>Uses a threshold of 2.5 by default. Use 0.5 for digital signals in {0, 1}.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hong2p.thor.tif2xml_root">
<span class="sig-prename descclassname"><span class="pre">hong2p.thor.</span></span><span class="sig-name descname"><span class="pre">tif2xml_root</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/thor.html#tif2xml_root"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.thor.tif2xml_root" title="Permalink to this definition"></a></dt>
<dd><p>Returns etree root of ThorImage XML settings from TIFF filename,
assuming TIFF was named and placed according to a certain convention.</p>
<p>Path can be to analysis output directory, as long as raw data directory
exists.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hong2p.thor.xmlroot">
<span class="sig-prename descclassname"><span class="pre">hong2p.thor.</span></span><span class="sig-name descname"><span class="pre">xmlroot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xml_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hong2p/thor.html#xmlroot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hong2p.thor.xmlroot" title="Permalink to this definition"></a></dt>
<dd><p>Loads contents of xml_path into xml.etree.ElementTree and returns root.</p>
<p>Use calls to &lt;node&gt;.find(&lt;child name&gt;) to traverse down tree and at leaves,
use &lt;leaf&gt;.attrib[&lt;attribute name&gt;] to get values. There are other functions
too, but see <cite>xml</cite> documentation for more information.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Element</span></code></p>
</dd>
</dl>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="hong2p.suite2p.html" class="btn btn-neutral float-left" title="hong2p.suite2p module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="hong2p.types.html" class="btn btn-neutral float-right" title="hong2p.types module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Tom O&#39;Connell.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>